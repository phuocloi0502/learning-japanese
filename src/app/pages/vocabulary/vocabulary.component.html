<div class="container-fluid">
  <!-- Header -->
  <div class="row">
    <div class="col-12">
      <div class="page-header text-center mb-4">
        <h1 class="display-4 fw-bold">üìö {{ title }}</h1>
        <p class="lead">{{ description }}</p>
      </div>
    </div>
  </div>

  <!-- Level Selector -->
  <div class="row mb-4">
    <div class="col-12">
      <div class="card">
        <div class="card-body">
          <div class="row align-items-center">
            <div class="col-md-6">
              <h5 class="mb-0">üéØ Ch·ªçn c·∫•p ƒë·ªô:</h5>
            </div>
            <div class="col-md-6">
              <select class="form-select" [(ngModel)]="selectedLevel" (change)="onLevelChange()">
                <option *ngFor="let level of availableLevels" [value]="level">
                  {{ level }} -
                  {{
                    level === 'N5'
                      ? 'C∆° b·∫£n'
                      : level === 'N4'
                      ? 'S∆° c·∫•p'
                      : level === 'N3'
                      ? 'Trung c·∫•p'
                      : level === 'N2'
                      ? 'Trung cao c·∫•p'
                      : 'Cao c·∫•p'
                  }}
                </option>
              </select>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="row">
    <div class="col-12">
      <div class="card">
        <div class="card-body text-center">
          <div class="spinner-border text-primary mb-3" role="status">
            <span class="visually-hidden">Loading...</span>
          </div>
          <h5>ƒêang t·∫£i d·ªØ li·ªáu {{ selectedLevel }}...</h5>
          <p class="text-muted">Vui l√≤ng ch·ªù trong gi√¢y l√°t</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Error State -->
  <div *ngIf="error && !isLoading" class="row">
    <div class="col-12">
      <div class="alert alert-danger" role="alert">
        <h4 class="alert-heading">‚ùå L·ªói!</h4>
        <p>{{ error }}</p>
        <hr />
        <p class="mb-0">
          <button class="btn btn-outline-danger" (click)="loadVocabularyData()">üîÑ Th·ª≠ l·∫°i</button>
        </p>
      </div>
    </div>
  </div>

  <!-- Vocabulary Content -->
  <div *ngIf="!isLoading && !error && chapters.length > 0" class="row">
    <div class="col-12">
      <!-- Stats -->
      <div class="card mb-4">
        <div class="card-body">
          <div class="row text-center">
            <div class="col-md-4">
              <div class="stat-item">
                <div class="stat-number text-primary">{{ chapters.length }}</div>
                <div class="stat-label">Ch∆∞∆°ng</div>
              </div>
            </div>
            <div class="col-md-4">
              <div class="stat-item">
                <div class="stat-number text-success">{{ getTotalVocabularyCount() }}</div>
                <div class="stat-label">T·ª´ v·ª±ng</div>
              </div>
            </div>
            <div class="col-md-4">
              <div class="stat-item">
                <div class="stat-number text-warning">{{ selectedLevel }}</div>
                <div class="stat-label">C·∫•p ƒë·ªô</div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Chapters -->
      <div class="row">
        <div class="col-lg-6 col-xl-4 mb-4" *ngFor="let chapter of chapters">
          <div class="card h-100 chapter-card">
            <div class="card-header">
              <h5 class="card-title mb-0">
                üìñ Ch∆∞∆°ng {{ chapter.chapter_number }}: {{ chapter.chapter_name }}
              </h5>
            </div>
            <div class="card-body">
              <p class="card-text">
                <strong>{{ chapter.lessonList.length }}</strong> b√†i h·ªçc
              </p>

              <div class="lessons-preview">
                <h6>üìù Danh s√°ch b√†i h·ªçc ({{ chapter.lessonList.length }} b√†i):</h6>
                <ul class="lesson-list">
                  <li *ngFor="let lesson of chapter.lessonList">
                    <a
                      [routerLink]="[
                        '/vocabulary',
                        selectedLevel,
                        chapter.chapter_number,
                        lesson.lesson_number
                      ]"
                      class="lesson-link"
                    >
                      <span class="lesson-number">{{ lesson.lesson_number }}.</span>
                      {{ lesson.lesson_name }}
                      <small class="text-muted">
                        (
                        <span
                          class="remembered-count"
                          [ngClass]="{ zero: (rememberedCountMap[lesson.lesson_id] || 0) === 0 }"
                          >{{ rememberedCountMap[lesson.lesson_id] || 0 }}</span
                        >
                        / {{ lesson.vocabularyList.length }} t·ª´ )
                      </small>
                    </a>
                  </li>
                </ul>
              </div>
            </div>
            <!-- <div class="card-footer">
              <button class="btn btn-primary btn-sm">
                üéØ H·ªçc ngay
              </button>
            </div> -->
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Empty State -->
  <div *ngIf="!isLoading && !error && chapters.length === 0" class="row">
    <div class="col-12">
      <div class="card">
        <div class="card-body text-center">
          <h5 class="card-title">üì≠ Ch∆∞a c√≥ d·ªØ li·ªáu</h5>
          <p class="card-text">Ch∆∞a c√≥ d·ªØ li·ªáu t·ª´ v·ª±ng cho c·∫•p ƒë·ªô {{ selectedLevel }}.</p>
          <button class="btn btn-primary" (click)="loadVocabularyData()">üîÑ T·∫£i l·∫°i</button>
        </div>
      </div>
    </div>
  </div>
</div>
